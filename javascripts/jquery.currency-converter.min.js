/*
 * jQuery Currency Converter Plugin
 * Version : 1.0
 * Plugin URL : https://valllabh.github.io/jquery.currency.converter
 * Author URL : http://vallabhjoshi.com
 * Author : Vallabh Joshi - copyright 2014
 * License : GPL Version 3
 * http://www.opensource.org/licenses/GPL-3.0
 */
(function(e){e.fn.currency_converter=function(t){function r(e){return t.currencies[e]?t.currencies[e]:false}function o(n){var i=[];for(c in t.currencies){var s=r(c);i.push(t.base+c)}var o=e.ajax({url:"http://query.yahooapis.com/v1/public/yql",dataType:"jsonp",data:{q:'select * from yahoo.finance.xchange where pair="'+i.join(",")+'"',format:"json",env:"store://datatables.org/alltableswithkeys"}});o.done(function(e){var r=e.query.results.rate,i;for(i in r){var s=r[i];cur_k=s.Name.substr(s.Name.length-3);if(t.currencies[cur_k]){t.currencies[cur_k].rate=s.Rate}}n()}).fail(function(e){n()})}function u(t,n){t=Number(e("<div>"+t+"</div>").text().replace(/[^0-9\.]+/g,""));n=r(n);t=f(t*(n.rate||1));return n.format.replace("{value}",t)}function a(n){n=r(n);if(n){e.each(e(t.target),function(){var t=e(this),r;r=t.data("base-value");if(!r){t.data("base-value",e(this).html())}r=t.data("base-value");e(this).html(u(r,n.key))})}}function f(e,n,r){c=isNaN(c=Math.abs(t.decimal))?2:c,n=n==undefined?".":n,r=r==undefined?",":r,s=e<0?"-":"",i=parseInt(e=Math.abs(+e||0).toFixed(c))+"",j=(j=i.length)>3?j%3:0;return s+(j?i.substr(0,j)+r:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+r)+(c?n+Math.abs(e-i).toFixed(c).slice(2):"")}var n=this,t=e.extend({base:"USD",decimal:0,target:".price",currencies:{USD:{key:"USD",rate:1,format:"${value}",label:"US Dollar"},INR:{key:"INR",rate:60,format:"{value} INR",label:"Indian Rupee"}}},t);o(function(){n.each(function(){var n=e("<select></select>"),i;for(i in t.currencies){var s=r(i),o;if(s){o=e("<option></option>");o.attr("value",i);o.html(s.label);n.append(o)}}n.change(function(){a(e(this).find(":selected").val())});e(this).append(n)})});return this}})(jQuery)